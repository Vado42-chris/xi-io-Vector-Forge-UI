/* App Layout - CSS Grid - NO INLINE STYLES */
/* Standard productized UI: Header | Main Content | Timeline | Footer */
.app-layout-grid {
  position: relative;
  width: 100vw;
  height: 100vh;
  color: var(--xibalba-text-000);
  font-family: var(--font-sans, sans-serif);
  overflow: hidden;
  background: var(--xibalba-grey-000);
  display: grid;
  grid-template-rows: auto 1fr auto auto; /* Header | Main Content | Timeline | Footer - NO GAPS */
  grid-template-columns: auto 1fr auto;
  grid-gap: 0; /* NO GAPS BETWEEN ROWS */
  gap: 0; /* NO GAPS */
  min-height: 100vh;
  isolation: isolate; /* Isolate grid from external styles */
}

.app-header-container {
  grid-row: 1 / 2;
  grid-column: 1 / 4;
  position: sticky;
  top: 0;
  z-index: var(--z-menu, 1100);
  isolation: isolate; /* Isolate header from other components */
  contain: layout style paint; /* Contain header layout */
  overflow: visible; /* Allow dropdowns to show */
}

.app-main-content {
  grid-row: 2 / 3;
  grid-column: 1 / 4;
  display: flex;
  height: 100% !important; /* CRITICAL: Fill grid cell exactly */
  min-height: 0 !important; /* CRITICAL: Allow flex shrinking */
  max-height: 100% !important; /* CRITICAL: Don't exceed grid cell */
  isolation: isolate; /* Isolate main content from header */
  contain: layout; /* Contain layout to prevent bleeding */
  position: relative;
  overflow: hidden !important; /* Prevent content from spilling */
  margin: 0 !important;
  padding: 0 !important;
  align-items: stretch !important; /* Force children to fill height */
  /* CRITICAL: Ensure this fills grid row 2 completely - no gaps */
  align-self: stretch !important;
  justify-self: stretch !important;
}

.app-canvas-area {
  flex: 1 1 0% !important; /* CRITICAL: Use 0% flex-basis, not auto */
  position: relative;
  overflow: hidden;
  background: var(--xibalba-grey-000);
  isolation: isolate; /* Isolate canvas from sidebars and header */
  contain: layout paint; /* Contain canvas layout and painting */
  z-index: var(--z-canvas, 10); /* Canvas below sidebars but above background */
  /* Account for fixed left sidebar - canvas starts after sidebar */
  margin-left: var(--sidebar-left-width, 320px);
  /* Account for fixed right sidebar - canvas ends before sidebar */
  margin-right: var(--sidebar-right-width, 360px);
  /* Width accounts for both sidebars */
  width: calc(100% - var(--sidebar-left-width, 320px) - var(--sidebar-right-width, 360px));
  min-width: 0 !important; /* Allow flex shrinking */
  min-height: 0 !important; /* CRITICAL: Allow flex shrinking - prevents gap */
  max-height: 100% !important; /* Don't exceed parent */
  height: 100% !important; /* CRITICAL: Fill parent height completely */
  margin-top: 0 !important;
  margin-bottom: 0 !important;
  padding: 0 !important;
  align-self: stretch !important; /* Force to fill parent height */
}

/* Timeline Container - In grid, NO FIXED POSITIONING, NO GAPS, EXACT HEIGHT */
.app-timeline-container {
  grid-row: 3 / 4;
  grid-column: 1 / 4;
  position: relative;
  z-index: var(--z-timeline-expanded, 100);
  isolation: isolate;
  contain: layout style paint;
  height: 200px !important; /* EXACT - NO VARIATION */
  min-height: 200px !important;
  max-height: 200px !important; /* NO EXPANSION */
  overflow: hidden !important;
  width: 100% !important;
  display: flex !important;
  flex-direction: column !important;
  margin: 0 !important;
  padding: 0 !important;
  gap: 0 !important;
  border: none !important;
}

/* Timeline inside grid container - FILLS CONTAINER EXACTLY, NO WRAPPER SPACE */
.app-timeline-container > *,
.app-timeline-container .xibalba-timeline,
.app-timeline-container .animation-timeline-container {
  position: relative !important;
  width: 100% !important;
  height: 100% !important;
  min-height: 100% !important;
  max-height: 100% !important;
  bottom: auto !important;
  left: auto !important;
  right: auto !important;
  margin: 0 !important;
  padding: 0 !important;
  flex: 1 1 100% !important;
}

/* Footer Container - Fixed at very bottom, NO GAPS */
.app-footer-container {
  grid-row: 4 / 5;
  grid-column: 1 / 4;
  position: relative;
  z-index: var(--z-timeline-expanded, 100);
  isolation: isolate;
  contain: layout style paint;
  height: 48px; /* Footer height - EXACT */
  min-height: 48px;
  max-height: 48px;
  margin: 0 !important;
  padding: 0 !important;
  gap: 0 !important;
}

