/* App Layout - CSS Grid - NO INLINE STYLES */
/* Master Template: Header | Main Content (Left + Center + Right) | Footer */
/* Bottom Drawer is fixed overlay, NOT in grid flow */

:root {
  --header-h: 56px;
  --tab-bar-h: 40px;
  --footer-h: 32px;
  --left-w: 320px; /* FIXED: Match actual sidebar width */
  --right-w: 360px; /* FIXED: Match actual sidebar width */
}

.app-layout-grid {
  position: relative;
  width: 100vw !important;
  height: 100vh !important;
  color: var(--xibalba-text-000);
  font-family: var(--font-sans, sans-serif);
  overflow: hidden;
  background: var(--xibalba-grey-000);
  display: grid !important;
  grid-template-rows: var(--header-h) var(--tab-bar-h) 1fr var(--footer-h) !important; /* Header | Tab Bar | Main | Footer - 4 ROWS */
  grid-template-columns: var(--left-w) 1fr var(--right-w) !important; /* Left | Center | Right */
  grid-gap: 0 !important; /* NO GAPS BETWEEN ROWS */
  gap: 0 !important; /* NO GAPS */
  min-height: 100vh !important;
  max-height: 100vh !important; /* CRITICAL: Don't exceed viewport */
  isolation: isolate; /* Isolate grid from external styles */
}

.app-header {
  grid-row: 1 / 2;
  grid-column: 1 / 4;
  position: relative;
  z-index: var(--z-menu, 1100);
  isolation: isolate;
  contain: layout style paint;
  overflow: visible;
  height: var(--header-h);
  min-height: var(--header-h);
  max-height: var(--header-h);
}

.app-tab-bar-container {
  grid-row: 2 / 3;
  grid-column: 1 / 4;
  position: relative;
  z-index: var(--z-menu, 400);
  isolation: isolate;
  contain: layout style paint;
  overflow: visible;
  height: var(--tab-bar-h);
  min-height: var(--tab-bar-h);
  max-height: var(--tab-bar-h);
}

.app-main-content {
  grid-row: 3 / 4; /* FIXED: Main content is row 3, not row 4 */
  grid-column: 1 / 4;
  display: grid !important; /* Grid for left/center/right columns */
  grid-template-columns: var(--left-w) 1fr var(--right-w) !important;
  height: 100% !important;
  min-height: 0 !important; /* CRITICAL: Allow shrinking */
  max-height: 100% !important;
  isolation: isolate;
  contain: layout;
  overflow: hidden !important;
  margin: 0 !important;
  padding: 0 !important;
  gap: 0 !important;
  align-self: stretch !important;
  justify-self: stretch !important;
}

.app-left {
  grid-column: 1 / 2;
  overflow-y: auto;
  overflow-x: hidden;
  height: 100%;
  min-height: 0;
  z-index: var(--z-sidebar-left, 100);
  position: relative;
}

.app-right {
  grid-column: 3 / 4;
  overflow-y: auto;
  overflow-x: hidden;
  height: 100%;
  min-height: 0;
  z-index: var(--z-sidebar-right, 100) !important; /* CRITICAL: Above bottom drawer (40) */
  position: relative;
}

.app-center {
  grid-column: 2 / 3;
  display: flex !important;
  flex-direction: column !important;
  overflow: hidden !important;
  height: 100% !important;
  min-height: 0 !important;
  position: relative !important;
}

.app-canvas-area {
  flex: 1 1 auto !important; /* Fill available space in flex container */
  min-height: 0 !important; /* CRITICAL: Allow flex shrinking */
  height: 100% !important; /* Fill parent completely */
  width: 100% !important; /* Fill parent width */
  overflow: hidden !important;
  background: var(--xibalba-grey-000) !important;
  isolation: isolate;
  contain: layout paint;
  z-index: var(--z-canvas, 10);
  margin: 0 !important;
  padding: 0 !important;
  position: relative !important; /* Relative, not absolute - let flex handle positioning */
}

/* Timeline Container - REMOVED - BottomDrawer is now fixed overlay, not in grid */
/* .app-timeline-container removed - BottomDrawer uses position: fixed */

/* Timeline inside grid container - FILLS CONTAINER EXACTLY, NO WRAPPER SPACE */
.app-timeline-container > *,
.app-timeline-container .xibalba-timeline,
.app-timeline-container .animation-timeline-container {
  position: relative !important;
  width: 100% !important;
  height: 100% !important;
  min-height: 100% !important;
  max-height: 100% !important;
  bottom: auto !important;
  left: auto !important;
  right: auto !important;
  margin: 0 !important;
  padding: 0 !important;
  flex: 1 1 100% !important;
}

/* Footer Container - Fixed at very bottom, NO GAPS */
.app-footer-container {
  grid-row: 4 / 5;
  grid-column: 1 / 4;
  position: relative;
  z-index: var(--z-timeline-expanded, 100);
  isolation: isolate;
  contain: layout style paint;
  height: var(--footer-h, 32px); /* Footer height - EXACT */
  min-height: var(--footer-h, 32px);
  max-height: var(--footer-h, 32px);
  margin: 0 !important;
  padding: 0 !important;
  gap: 0 !important;
}
